<!DOCTYPE html>
<!-- CSP support mode (required for Windows Universal apps): https://docs.angularjs.org/api/ng/directive/ngCsp -->
<html lang="en" ng-app="app" ng-csp>
<head>
    <meta charset="utf-8" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="mobile-web-app-capable" content="yes" />

    <!-- CSS dependencies -->
    <link rel="stylesheet" href="../lib/onsen/css/onsenui.css" />
    <link rel="stylesheet" href="../lib/onsen/css/onsen-css-components.css" />
    <link rel="stylesheet" href="../style.css" />
    <!-- JS dependencies (order matters!) -->
    <script src="../js/jquery-3.4.1.js"></script>
    <script src="../lib/onsen/js/onsenui.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
    <!-- Async script executes immediately and must be after any DOM elements used in callback. -->
    
      <!-- --------------- App init --------------- -->

    <title>Agenda Escolar</title>

    <style>
    #map {
        height: 100%;
    }

    .fundo{
      position: absolute;
       width: 100%;
       height: 95%;
       
    }
    .interno{
      position: relative;
      margin-top: 100px;
      margin-bottom: 100px;
       width: 100%;
       height: 100%;
       
    }
     .login{
        margin: 5% auto ;
        text-align: center;
        width: 90%;
        height: 100%;
        background: white;
        -webkit-box-shadow: 1px 1px 20px rgba(50, 50, 50, 0.77);
        -moz-box-shadow:    1px 1px 20px rgba(50, 50, 50, 0.77);
        box-shadow:         1px 1px 20px rgba(50, 50, 50, 0.77);
        font-family: Arial;
        color: gray;
     }

    </style>


</head>
<body>
<!-- Cordova reference -->
<script src="../js/config.js"></script>
<script src="../cordova.js"></script> 
<script src="../scripts/index.js"></script>
<script src="../js/cadastro.js"></script>
<script src="../js/function.js"></script>
<script>
    let map;

    $(document).ready(function(){

      $('#iniciarbusca').click(function(){
        initMap(-19.780191 , -42.143092, "Você está aqui");
      });


      $('#bt_voltar').click(function(){

        direcionar("../app.html");

      });
      
    });
    
    function initMap(lat, long, info) {
      let latt = -19.790191 , longg = -42.143092;

      if(lat){
        latt = lat;
      }
      if(long){
        longg = long;
      }
      if(!info){
        info = 'Escola Liber';
      }
      const escola = {
          zoom: 18,
          center: { lat: latt, lng: longg}
      };

      /*Se o mapa não existir, cria o mapa no objeto #map */
      if(typeof map != 'object'){
       map = new google.maps.Map(document.getElementById("map"), escola);
      }
      /*Se o mapa existir, apenas muda o centro dele */
      else{
        const center = new google.maps.LatLng(latt, longg);
        map.panTo(center);
      }
      const marker = new google.maps.Marker({
          // The below line is equivalent to writing:
          // position: new google.maps.LatLng(-34.397, 150.644)
          position: { lat:latt, lng: longg},
          map: map,
      });
      // You can use a LatLng literal in place of a google.maps.LatLng object when
      // creating the Marker object. Once the Marker object is instantiated, its
      // position will be available as a google.maps.LatLng object. In this case,
      // we retrieve the marker's position using the
      // google.maps.LatLng.getPosition() method.
      const infowindow = new google.maps.InfoWindow({
        content: "<p>"+info+": " + marker.getPosition() + "</p>",
      });
      google.maps.event.addListener(marker, "click", () => {
        infowindow.open(map, marker);
      });
}

    </script>
<ons-page  modifier="menu-page" >
    <ons-toolbar>
      <div class="left">
                     <!-- Toolbar-button  only visible for iOS/other. -->
        <ons-toolbar-button id="bt_voltar" component="buttonreload">
          <!--<ons-icon icon="fa-undo"></ons-icon>-->
           <ons-icon icon="md-arrow-left"></ons-icon>
        </ons-button>
      </div>

      <div class="center">Buscar Estudante</div>
      <div class="right" style="color:#56c2cd">
        .
        
        </ons-button>
      </div>
    </ons-toolbar>
    
    <div id="map">
                     
      </div>
    <div class='positionbottom3'>
      <button id='iniciarbusca' class="button">Buscar/Entregar Estudante</button>
    </div>
</ons-page>

    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDtuymfuo5u4zDlZJGaGt62D9UcDq6pW8I&callback=initMap&libraries=&v=weekly"
      async
    ></script>
</body>
</html>